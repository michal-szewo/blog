<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:th="http://www.thymeleaf.org">
  <head>
  	<title>Blog</title>
	<th:block th:include="fragments/general.html :: headerfiles">
        </th:block>
  	
</head>

<body class="container m-auto rounded">
   
     <header class="py-5 mx-3 bg-dark bg-gradient rounded text-white text-center d-flex align-items-center position-relative">
       <div class="position-absolute top-0 end-0 p-2">Witaj, <span th:text="${user.username}">User</span></div>
      <div class="col-lg-2 mx-2"><i class="material-icons" style="font-size:68px;color:white">import_contacts</i></div>
      <div class="col-lg-10 d-flex justify-content-start mx-2"><h1>Blog - wszystkie posty</h1></div>
      <nav class="position-absolute bottom-0 end-0 d-flex align-items-center">
      <a class="btn text-white d-flex align-items-center" onclick="event.preventDefault();var myCollapse = document.getElementById('collapseForm');var bsCollapse = new bootstrap.Collapse(myCollapse, {toggle: true})" ><i class="material-icons" style="color:white" >add</i> Utwórz artykuł</a> | 
      <!--<a class="btn text-white d-flex align-items-center" th:href="@{/logout}"><i class="material-icons" style="color:white">person</i> Wyloguj</a>-->
      <a class="btn text-white d-flex align-items-center" href="javascript: document.logoutForm.submit()" role="menuitem">Wyloguj</a>
           <form name="logoutForm" th:action="@{/logout}" method="post" th:hidden="true">
                        <input hidden type="submit" value="Sign Out"/></form>
      </nav>
    </header>
    <main>
    
    <div id="posts" >
      
            <h2 th:if="${articles == null || articles.size ==0}" class="m-3 p-3r">Brak artykułów do wyświetlenia</h2>
      		
          
          <div th:unless="${articles == null || articles.size ==0}">
          
            <article th:each="article : ${articles}" class="border m-3 p-3 shadow-sm rounded card position-relative">
	            <div th:if="${article.author.id == user.id}" class="btn btn-white position-absolute top-0 end-0 d-flex align-items-center m-0 p-0">
	            <a th:href="@{'/articles/edit/{id}'(id=${article.id})}" class="btn btn-white d-flex align-items-center"><i class="material-icons">mode_edit</i> Edytuj
		    			</a>
		           <form th:action="@{'/articles/delete/{id}'(id=${article.id})}" th:method="delete" class="btn btn-white d-flex align-items-center">
		    			<button type="submit" class="btn align-items-center d-flex">
		        								<i class="material-icons">delete_forever</i> Usuń
		    			</button>
					</form>
	            </div>
                
                <h2 class="blog-post-title card-title" th:text="${article.title}">Title</h2>
                <p class="blog-post-meta text-muted"><span th:text="${#dates.format(article.publishedAt, 'dd-MM-yyyy HH:mm')}">publishedAt</span> By <span th:text="${article.author.username}">Author</span></p>
        
                <p class="card-text" th:utext="${article.body}">Body</p>
              </article>
         </div>
    
        
         
    </div>
    <div id="add_post "class="row fixed-bottom bg-light border-top border-primary">
    <button class="btn btn-primary btn-lg ds-flex align-content-center" type="button" data-bs-toggle="collapse" data-bs-target="#collapseForm" aria-expanded="false"><i class="material-icons">add</i>&nbsp;<span>Utwórz nowy artykuł</span></button>
      
        <div class="collapse" id="collapseForm">
        
	        <form th:action="@{/addArticle}" th:object="${newArticle}" class="col-lg-6 mx-auto p-3" method="post" id="addForm">
	        
		         <div class="mb-3 mt-3">
		          <label for="postTitle" class="form-label">Temat posta:</label>
		          <input type="text" th:field="*{title}" class="form-control" required>
		         </div>
		         <div class="mb-3">
		          <label for="postBody" class="form-label">Treść posta:</label>
		          <textarea th:field="*{body}" class="form-control" style="resize:none" rows="3"></textarea>
		         </div>
		         
		    	 <div>
		          <button type="submit" class="btn btn-md btn-primary d-flex mt-3 align-items-center"><i class="material-icons">add</i>&nbsp;Dodaj artykuł</button>
		         </div>
	        
	        </form>
        </div>
    </div>
         
    </main>
    <script>
      tinymce.init({
        selector: 'textarea#body',
        plugins: 'link image lists code',
        toolbar: 'undo redo | styles | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image code| forecolor language',
        language: 'pl'
       
  		
      });
    </script>
    <footer th:replace="fragments/general.html :: footer"></footer>
    </body>
</html>